{% apply spaceless %}
{% set profilePhoto = 'img/avatar2.png' %}
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>{% block title %}{% endblock %} | {{  title_long }}</title>
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <meta name="generator" content="SEMART SKELETON" />
    <meta name="version" content="{{ version }}" />
    <meta name="source" content="https://github.com/KejawenLab/SemartSkeleton" />
    <meta name="author" content="MUHAMAD SURYA IKSANUDIN" />
    <meta name="email" content="surya.kejawen@gmail.com" />
    <meta name="msapplication-config" content="{{ asset('browserconfig.xml') }}">
    <!-- Google Font: Source Sans Pro -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback">
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="{{ asset('adminlte3/plugins/fontawesome-free/css/all.min.css') }}">
    <!-- IonIcons -->
    <link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <!-- Theme style -->
    <link rel="stylesheet" href="{{ asset('adminlte3/css/adminlte.min.css') }}">

{#    <link rel="stylesheet" href="{{ asset('lib/bootstrap/dist/css/bootstrap.min.css') }}">#}
{#    <link rel="stylesheet" href="{{ asset('lib/font-awesome/css/font-awesome.min.css') }}">#}
{#    <link rel="stylesheet" href="{{ asset('lib/Ionicons/css/ionicons.min.css') }}">#}
{#    <link rel="stylesheet" href="{{ asset('css/AdminLTE.min.css') }}">#}
{#    <link rel="stylesheet" href="{{ asset('css/skins/skin-purple.min.css') }}">#}
    <link rel="stylesheet" href="{{ asset('css/semart.css') }}">
    <link rel="apple-touch-icon" sizes="180x180" href="{{ asset('apple-touch-icon.png') }}">
    <link rel="icon" type="image/png" sizes="32x32" href="{{ asset('favicon-32x32.png') }}">
    <link rel="icon" type="image/png" sizes="16x16" href="{{ asset('favicon-16x16.png') }}">
    <link rel="manifest" href="{{ asset('site.webmanifest')}}">
    <link rel="mask-icon" href="{{ asset('safari-pinned-tab.svg') }}">
    <link rel="shortcut icon" href="{{ asset('favicon.ico') }}">
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
{#    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,700,300italic,400italic,600italic">#}
    <link rel="stylesheet" href="{{ asset('lib/toastr/toastr.min.css') }}">
    <style>
        #first-loader.basic-loader {
            display: none;
            z-index: 9998;
            background-image: url('{{ asset('img/loader.gif') }}');
            background-color: #f8f8f8;
            position: fixed;
        }

        .basic-loader {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: hsla(0, 0%, 100%, 0.8);
            background-position: center;
            background-repeat: no-repeat;
            /*background-size: 70px 70px;*/
            z-index: 9998;
        }

        .basic-loader.fixed-container {
            position: fixed !important;
            z-index: 9998;
        }

        .mouse-pointer {
            cursor: pointer;
        }
    </style>
    {% block stylesheets %}{% endblock %}
</head>
<body class="hold-transition sidebar-mini text-sm">
    {% block top_nav_widget %}{% endblock %}
    {% set user = app.user %}
    {% set group = user.group %}
    <div class="wrapper">
        <!-- Navbar -->
{#        <nav class="main-header navbar navbar-expand navbar-white navbar-light">#}
        <nav class="main-header navbar navbar-expand navbar-dark navbar-lightblue">
            <!-- Left navbar links -->
            <ul class="navbar-nav">
                <li class="nav-item">
                    <a class="nav-link" data-widget="pushmenu" href="#" role="button"><i class="fas fa-bars"></i></a>
                </li>
                <li>
                    <a href="#" class="nav-link">{% block page_title %}{% endblock %}</a>
                </li>
                {#
                <li class="nav-item d-none d-sm-inline-block">
                    <a href="{{ path('home_dashboard') }}" class="nav-link">Home</a>
                </li>
                <li class="nav-item d-none d-sm-inline-block">
                    <a href="#" class="nav-link">Contact</a>
                </li>
                #}
            </ul>

            <!-- SEARCH FORM -->
            {#
            <form class="form-inline ml-3">
                <div class="input-group input-group-sm">
                    <input class="form-control form-control-navbar" type="search" placeholder="Search" aria-label="Search">
                    <div class="input-group-append">
                        <button class="btn btn-navbar" type="submit">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>
                </div>
            </form>
            #}

            <!-- Right navbar links -->
            <ul class="navbar-nav ml-auto">
                <li class="nav-item dropdown user user-menu">
                    <a href="#" class="nav-link" data-toggle="dropdown">
                        <img src="{{ asset(profilePhoto) }}" class="user-image" alt="{{ user.username }}">
                        <span class="hidden-xs">{{ user.username }}</span>
                    </a>

                    <ul class="dropdown-menu dropdown-menu-lg dropdown-menu-right">
                        <li class="user-header">
                            <img src="{{ asset(profilePhoto) }}" class="img-circle" alt="{{ user.username }}">
                            <p>{{ user.fullName }}<small>{{ group.code ~ ' - ' ~ group.name }}</small></p>
                        </li>
                        <li class="user-footer col-md-12">
                            <div class="float-left">
                                <a href="{{ path('profile_index') }}" class="btn btn-default btn-flat">{{ 'label.user.profile' | trans }}</a>
                            </div>
                            <div class="float-right">
                                <a href="{{ path('logout') }}" class="btn btn-default btn-flat">{{ 'label.login.logout' | trans }}</a>
                            </div>
                        </li>
                    </ul>
                </li>
                {#
                <li class="nav-item">
                    <a class="nav-link" data-widget="control-sidebar" data-slide="true" href="#" role="button">
                        <i class="fas fa-th-large"></i>
                    </a>
                </li>
                #}
            </ul>
        </nav>
        <!-- /.navbar -->

        <!-- Main Sidebar Container -->
{#        <aside class="main-sidebar sidebar-dark-primary elevation-4">#}
        <aside class="main-sidebar elevation-4 sidebar-light-lightblue">
            <!-- Brand Logo -->
            <a href="{{ path('home_dashboard') }}" class="brand-link">
                <img src="{{ asset('adminlte3/img/AdminLTELogo.png') }}" alt="AdminLTE Logo" class="brand-image img-circle elevation-3" style="opacity: .8">
                <span class="brand-text font-weight-light">{{ app_title }}</span>
            </a>

            <!-- Sidebar -->
            <div class="sidebar">
                <!-- Sidebar user panel (optional) -->
                <div class="user-panel mt-3 pb-3 mb-3 d-flex">
                    <div class="image">
                        <img src="{{ asset(profilePhoto) }}" class="img-circle elevation-2" alt="{{ user.username }}">
                    </div>
                    <div class="info">
                        <a href="#" class="d-block">{{ user.fullName }}</a>
                    </div>
                </div>

                <!-- SidebarSearch Form -->
                {#
                <div class="form-inline">
                    <div class="input-group" data-widget="sidebar-search">
                        <input class="form-control form-control-sidebar" type="search" placeholder="Search" aria-label="Search">
                        <div class="input-group-append">
                            <button class="btn btn-sidebar">
                                <i class="fas fa-search fa-fw"></i>
                            </button>
                        </div>
                    </div>
                </div>
                #}

                <!-- Sidebar Menu -->
                <nav class="mt-2">
                    <ul class="nav nav-pills nav-sidebar flex-column" data-widget="treeview" role="menu" data-accordion="false">
                        <!-- Add icons to the links using the .nav-icon class
                             with font-awesome or any other icon font library -->
                        {{ render_menu_new(app.request.pathInfo) | raw }}
                    </ul>
                </nav>
                <!-- /.sidebar-menu -->
            </div>
            <!-- /.sidebar -->
        </aside>

        <!-- Content Wrapper. Contains page content -->
        <div class="content-wrapper">
            {#
            <!-- Content Header (Page header) -->
            <div class="content-header">
                <div class="container-fluid">
                    <div class="row mb-2">
                        <div class="col-sm-6">
                            <h1 class="m-0 text-dark">&nbsp;</h1>
                        </div><!-- /.col -->
                        <div class="col-sm-6">
                            <ol class="breadcrumb float-sm-right">
                                {% block breadcrumb %}{% endblock %}
                            </ol>
                        </div><!-- /.col -->
                    </div><!-- /.row -->
                </div><!-- /.container-fluid -->
            </div>
            <!-- /.content-header -->
            #}

            <!-- Main content -->
            <div class="content">
                <div class="container-fluid">
                    {% block content %}{% endblock %}
                </div>
                <!-- /.container-fluid -->
            </div>
            <!-- /.content -->
        </div>
        <!-- /.content-wrapper -->
        {#
        <div class="content-wrapper">
            <section class="content-header">
                <h1>{% block page_title %}{% endblock %}</h1>
                <ol class="breadcrumb">
                    {% block breadcrumb %}{% endblock %}
                </ol>
            </section>
            <section class="content">
                {% block content %}{% endblock %}
            </section>
        </div>
        #}
        <!-- Control Sidebar -->
        <aside class="control-sidebar control-sidebar-dark">
            <!-- Control sidebar content goes here -->
        </aside>
        <!-- /.control-sidebar -->

        <!-- Main Footer -->
        <footer class="main-footer">
            {% set year = date('now') | date('Y') %}
            <strong>Copyright &copy; {{ year > 2020 ? 2020 ~ ' - ' ~ year : 2020 }}.</strong>
            All rights reserved.
            <div class="float-right d-none d-sm-inline-block">
                <b>Version</b> {{ version }}
            </div>
        </footer>
    </div>
    <!-- REQUIRED SCRIPTS -->

    <!-- jQuery -->
    <script src="{{ asset('adminlte3/plugins/jquery/jquery.min.js') }}"></script>
    <!-- Bootstrap -->
    <script src="{{ asset('adminlte3/plugins/bootstrap/js/bootstrap.bundle.min.js') }}"></script>
    <!-- AdminLTE -->
    <script src="{{ asset('adminlte3/js/adminlte.js') }}"></script>

    <script src="{{ asset('lib/toastr/toastr.min.js') }}"></script>
    <script src="{{ asset('js/jquery.numeric.min.js') }}"></script>
    <script src="{{ asset('bundles/fosjsrouting/js/router.min.js') }}"></script>
    <script src="{{ path('fos_js_routing_js', { callback: 'fos.Router.setData' }) }}"></script>
    <script>
        $(document).ready(function () {
            toastr.options = {
                'closeButton': false,
                'debug': false,
                'newestOnTop': false,
                'progressBar': false,
                'positionClass': 'toast-top-right',
                'preventDuplicates': false,
                'onclick': null,
                'showDuration': '300',
                'hideDuration': '1000',
                'timeOut': '3000',
                'extendedTimeOut': '1000',
                'showEasing': 'swing',
                'hideEasing': 'linear',
                'showMethod': 'fadeIn',
                'hideMethod': 'fadeOut'
            };

            $('[data-toggle="tooltip"]').tooltip();

            $('.modal').on('hidden.bs.modal', function () {
                $(this)
                    .find('input,textarea,select')
                    .val('')
                    .end()
                    .find('input[type=checkbox], input[type=radio]')
                    .prop('checked', '')
                    .end()
                ;
            });

            $('.numeric').keyup(function(e) {
                if (/\D/g.test(this.value)) {
                    this.value = this.value.replace(/\D/g, '');
                }
            });

            sort($('.sortable-default'));

            $('.phoneNumber').number(true, 0, '.', '-');
            $('.number').number(true, 0);

            $(document).on('click', '.sortable', function () {
                sort(jQuery(this));
            });

            $(document).on('click', '.refresh', function () {
                refreshTable(window.location.href, '{{ title }}');
            });

            let params = getQueriesString();
            if ('undefined' !== typeof params['m']) {
                let menu = jQuery('.' + params['m']);
                let parents = menu.parentsUntil(jQuery('.sidebar-menu'));
                menu.addClass('active');
                parents.addClass('menu-open');
                parents.addClass('active');
            }

            if ('undefined' !== typeof params['q']) {
                delete params['q'];

                refreshTable(window.location.href.split('?')[0] + '?' + $.param(params), '{{ title }}');
            }

            if ('undefined' !== typeof params['s']) {
                jQuery('.sortable').each(function () {
                    let elm = jQuery(this);
                    let sortField = elm.data('sort-field');
                    let direction = params['d'];
                    if (sortField === params['s']) {
                        elm.removeClass('fa-sort');
                        elm.removeClass('fa-sort-asc');
                        elm.removeClass('fa-sort-desc');
                        switch (direction) {
                            case 'n':
                                elm.addClass('fa-sort');
                                break;
                            case 'a':
                                elm.addClass('fa-sort-asc');
                                break;
                            case 'd':
                                elm.addClass('fa-sort-desc');
                                break;
                        }
                    }
                });
            }
        });

        $(window).ready(function () {
            $('.menu-open.active').children().addClass('active');
        });

        function refreshTable(url, title) {
            let container = $('body');

            container.semartLoader();

            $.get(url, {}, function (response) {
                $('.table-content').html(response['table']);
                $('.pagination-box').html(response['pagination']);

                localStorage.setItem('cache_id', response['_cache_id']);
                window.history.pushState(response, title, url);

                container.trigger('destroy.semart.loader');
            });
        }

        function formReset(callback) {
            let form = $('#semartForm');

            form.trigger('reset');
            let select = form.find('select');
            select.prop('selectedIndex', 0);
            $.each(select, function() {
                if ($(this).hasClass('select2-static')) {
                    $(this).select2();
                }
            });
            if ('function' === typeof callback) {
                callback();
            }
        }

        function sort(element) {
            jQuery('.sortable').each(function () {
                let elm = jQuery(this);

                elm.removeClass('fa-sort');
                elm.removeClass('fa-sort-asc');
                elm.removeClass('fa-sort-desc');
                if (!elm.is(element)) {
                    elm.addClass('fa-sort');
                    elm.data('sort', 'no');
                }
            });

            let direction = element.data('sort');
            let field = element.data('sort-field');
            switch (direction) {
                case 'no':
                    element.removeClass('fa-sort');
                    element.addClass('fa-sort-asc');
                    element.data('sort', 'asc');
                    direction = 'a';
                    break;
                case 'asc':
                    element.removeClass('fa-sort-asc');
                    element.addClass('fa-sort-desc');
                    element.data('sort', 'desc');
                    direction = 'd';
                    break;
                case 'desc':
                    element.removeClass('fa-sort-desc');
                    element.addClass('fa-sort');
                    element.data('sort', 'no');
                    direction = 'n';
                    break;
            }

            let params = getQueriesString();

            params['s'] = field;
            params['d'] = direction;

            if (direction && field) {
                refreshTable(window.location.href.split('?')[0] + '?' + $.param(params), '{{ title }}');
            }
        }

        function upload(formData, callback) {
            $.ajax({
                url:Routing.generate('files_upload'),
                data: formData,
                type: 'post',
                contentType:false,
                processData:false,
                cache:false,
                dataType: 'json',
                error:function(err){
                    localStorage.setItem('csrf_token', err._csrf_token);
                },
                success:function(response){
                    localStorage.setItem('csrf_token', response._csrf_token);
                    if ('OK' === response.status) {
                        if ('function' === typeof callback) {
                            callback(response.files);
                        }
                    }
                }
            });
        }

        function getQueriesString() {
            let vars = {};
            let hash = null;
            let hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
            for(let i = 0; i < hashes.length; i++) {
                hash = hashes[i].split('=');
                if ('undefined' !== typeof hash[1]) {
                    vars[hash[0]] = hash[1];
                }
            }

            return vars;
        }

        (function ($) {
            $.fn.semartLoader = function (opt) {
                let $element = this;

                let loader = new Loader($element, opt); //initialize loader
                //initialize custom handler to the elements
                let handler = {
                    'destroy.semart.loader': $.proxy(function () {
                        let self = this;
                        loader.destroy();
                    }, this)
                };
                $element.on(handler);

                return $element;
            };

            // default settings
            let settings = {
                loader_img: '{{ asset('img/loader.gif') }}',
                className: 'basic-loader',
                containerName: 'loader-container',
                minHeight: 200,
                fixedLoader: false,
                afterDestroy: function () {
                    //after loader destroyed, what you will do, put it here
                }
            };

            let Loader = function (target, opt) {
                if (target.length < 1) {
                    return;
                }

                this.$target = target;
                this.$obj = {};
                this.settings = $.extend(settings, opt);

                this._htmlInit();
            };

            Loader.prototype._htmlInit = function () {
                let self = this;
                let $obj = $('<div/>', {
                    'class': self.settings.className + (self.settings.fixedLoader ? ' fixed-container' : ''),
                    'style': 'background-image:url(' + self.settings.loader_img + ')'
                });
                self.$target.addClass(self.settings.containerName);
                self.$target.get(0).style.minHeight = self.settings.minHeight + 'px';
                self.$target.append($obj);
                self.$obj = self.$target.find('.' + self.settings.className);
            };

            Loader.prototype.destroy = function () {
                let self = this;
                self.$obj.fadeOut(500).promise().done(function () {
                    self.$obj.remove();
                    if (self.settings.afterDestroy)
                        self.settings.afterDestroy();
                    //self.$target.removeClass(self.settings.containerName);
                    self.$target.get(0).style.minHeight = '';
                });
            };
        }(jQuery));
    </script>
    {% block javascripts %}{% endblock %}
</body>
</html>
{% endapply %}
